<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>دیتابیس تلفون‌های همراه - سیستم مدیریت</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Vazirmatn:wght@300;400;500;600;700;800&display=swap">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- Loading Indicator -->
    <div class="loading-indicator" id="loadingIndicator">
        <div class="loading-spinner"></div>
    </div>

    <!-- Connection Status -->
    <div class="connection-status online" id="connectionStatus">
        <i class="fas fa-wifi"></i>
        <span id="statusText">متصل به دیتابیس</span>
    </div>

    <!-- Authentication Section -->
    <div class="auth-container" id="authContainer">
        <div class="auth-card">
            <div class="auth-logo">
                <div class="auth-logo-icon">
                    <i class="fas fa-mobile-alt"></i>
                </div>
                <h1>دیتابیس تلفون‌های همراه</h1>
                <p>لطفاً وارد سیستم شوید</p>
            </div>
            
            <div class="auth-tabs">
                <button class="auth-tab active" id="loginTab">ورود</button>
                <button class="auth-tab" id="registerTab">ثبت نام</button>
            </div>
            
            <!-- Login Form -->
            <form class="auth-form active" id="loginForm">
                <div class="auth-form-group">
                    <label for="loginEmail">ایمیل</label>
                    <div class="input-with-icon">
                        <i class="fas fa-envelope input-icon"></i>
                        <input type="email" id="loginEmail" class="auth-form-control with-icon" 
                               placeholder="ایمیل خود را وارد کنید" 
                               required>
                    </div>
                    <div class="error-message" id="loginEmailError"></div>
                </div>
                
                <div class="auth-form-group">
                    <label for="loginPassword">رمز عبور</label>
                    <div class="password-container">
                        <i class="fas fa-lock input-icon"></i>
                        <input type="password" id="loginPassword" class="auth-form-control with-icon" 
                               placeholder="رمز عبور خود را وارد کنید" 
                               required>
                        <button type="button" class="password-toggle" id="loginPasswordToggle">
                            <i class="fas fa-eye"></i>
                        </button>
                    </div>
                    <div class="error-message" id="loginPasswordError"></div>
                </div>
                
                <button type="submit" class="auth-btn" id="loginBtn">
                    <i class="fas fa-sign-in-alt"></i>
                    <span id="loginBtnText">ورود به سیستم</span>
                    <span id="loginLoading" class="hidden"><i class="fas fa-spinner fa-spin"></i></span>
                </button>
                
                <div class="auth-links">
                    <p class="small">برای ثبت‌نام به عنوان کاربر عادی، روی "ثبت نام" کلیک کنید</p>
                </div>
            </form>
            
            <!-- Register Form -->
            <form class="auth-form" id="registerForm">
                <div class="auth-form-group">
                    <label for="registerName">نام کامل</label>
                    <div class="input-with-icon">
                        <i class="fas fa-user input-icon"></i>
                        <input type="text" id="registerName" class="auth-form-control with-icon" 
                               placeholder="نام و نام خانوادگی" 
                               required>
                    </div>
                    <div class="error-message" id="registerNameError"></div>
                </div>
                
                <div class="auth-form-group">
                    <label for="registerEmail">ایمیل</label>
                    <div class="input-with-icon">
                        <i class="fas fa-envelope input-icon"></i>
                        <input type="email" id="registerEmail" class="auth-form-control with-icon" 
                               placeholder="ایمیل معتبر وارد کنید" 
                               required>
                    </div>
                    <div class="error-message" id="registerEmailError"></div>
                </div>
                
                <div class="auth-form-group">
                    <label for="registerPassword">رمز عبور</label>
                    <div class="password-container">
                        <i class="fas fa-lock input-icon"></i>
                        <input type="password" id="registerPassword" class="auth-form-control with-icon" 
                               placeholder="رمز عبور قوی (حداقل ۶ کاراکتر)" 
                               required minlength="6">
                        <button type="button" class="password-toggle" id="registerPasswordToggle">
                            <i class="fas fa-eye"></i>
                        </button>
                    </div>
                    <div class="error-message" id="registerPasswordError"></div>
                </div>
                
                <div class="auth-form-group">
                    <label for="registerConfirmPassword">تکرار رمز عبور</label>
                    <div class="password-container">
                        <i class="fas fa-lock input-icon"></i>
                        <input type="password" id="registerConfirmPassword" class="auth-form-control with-icon" 
                               placeholder="تکرار رمز عبور" 
                               required>
                        <button type="button" class="password-toggle" id="registerConfirmPasswordToggle">
                            <i class="fas fa-eye"></i>
                        </button>
                    </div>
                    <div class="error-message" id="registerConfirmPasswordError"></div>
                </div>
                
                <div class="auth-form-group">
                    <label>نقش کاربری</label>
                    <div class="role-selector">
                        <div class="role-option admin disabled">
                            <i class="fas fa-user-shield role-icon"></i>
                            <div>مدیر سیستم</div>
                            <small>فقط یک مدیر سیستم وجود دارد</small>
                            <input type="radio" name="role" value="admin" disabled>
                        </div>
                        <div class="role-option user active">
                            <input type="radio" name="role" value="user" checked>
                            <i class="fas fa-user role-icon"></i>
                            <div>کاربر عادی</div>
                            <small>فقط مشاهده اطلاعات</small>
                        </div>
                    </div>
                </div>
                
                <button type="submit" class="auth-btn" id="registerBtn">
                    <i class="fas fa-user-plus"></i>
                    <span id="registerBtnText">ثبت نام</span>
                    <span id="registerLoading" class="hidden"><i class="fas fa-spinner fa-spin"></i></span>
                </button>
                
                <div class="auth-links">
                    <p>قبلاً حساب دارید؟ <a href="#" class="auth-link" id="loginLink">وارد شوید</a></p>
                </div>
            </form>
            
            <!-- Test Credentials -->
            <div class="test-credentials">
                <h4>اطلاعات ورود مدیر سیستم:</h4>
                <div class="credentials">
                    <div class="credential-item">
                        <strong>مدیر سیستم (فقط یک مدیر)</strong>
                        ایمیل: <br>
                        رمز عبور: <br>
                        <small>این اطلاعات قابل تغییر نیستند</small>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Application (after login) -->
    <div class="app-container" id="appContainer">
        <!-- Language Toggle -->
        <div class="language-toggle">
            <button class="lang-btn app" id="languageToggle">
                <i class="fas fa-language"></i>
                <span id="languageText">پښتو</span>
            </button>
        </div>

        <!-- Header -->
        <header>
            <div class="container">
                <div class="header-content">
                    <button class="mobile-menu-btn" id="mobileMenuBtn">
                        <i class="fas fa-bars"></i>
                    </button>
                    
                    <div class="app-logo">
                        <div class="app-logo-icon">
                            <i class="fas fa-mobile-alt"></i>
                        </div>
                        <div class="app-logo-text">
                            <h1>دیتابیس تلفون‌های همراه</h1>
                            <p id="headerRoleText">سیستم مدیریت</p>
                        </div>
                    </div>
                    
                    <div class="user-info mobile-hidden" id="userInfoDesktop">
                        <div class="user-avatar user" id="userAvatar">
                            <span id="avatarText">ک</span>
                        </div>
                        <div class="user-details">
                            <div class="user-name" id="userName">کاربر مهمان</div>
                            <div class="user-role" id="userRole">کاربر عادی</div>
                        </div>
                        <button class="logout-btn" id="logoutBtn">
                            <i class="fas fa-sign-out-alt"></i>
                        </button>
                    </div>
                </div>
                
                <!-- Mobile User Info -->
                <div class="user-info mobile-visible hidden" id="userInfoMobile">
                    <div class="user-avatar user" id="userAvatarMobile">
                        <span id="avatarTextMobile">ک</span>
                    </div>
                    <div class="user-details">
                        <div class="user-name" id="userNameMobile">کاربر مهمان</div>
                        <div class="user-role" id="userRoleMobile">کاربر عادی</div>
                    </div>
                    <button class="logout-btn" id="logoutBtnMobile">
                        <i class="fas fa-sign-out-alt"></i>
                    </button>
                </div>
            </div>
        </header>

        <div class="container">
            <!-- Stats Section -->
            <div class="stats-section">
                <div class="stat-card stat-1">
                    <div class="stat-icon">
                        <i class="fas fa-mobile-alt"></i>
                    </div>
                    <div class="stat-info">
                        <h3 id="totalPhones">0</h3>
                        <p id="totalPhonesText">تعداد تلفون‌ها</p>
                    </div>
                </div>
                <div class="stat-card stat-2">
                    <div class="stat-icon">
                        <i class="fas fa-dollar-sign"></i>
                    </div>
                    <div class="stat-info">
                        <h3 id="avgPrice">0</h3>
                        <p id="avgPriceText">میانگین قیمت</p>
                    </div>
                </div>
                <div class="stat-card stat-3">
                    <div class="stat-icon">
                        <i class="fas fa-microchip"></i>
                    </div>
                    <div class="stat-info">
                        <h3 id="totalParts">0</h3>
                        <p id="totalPartsText">قطعات ثبت شده</p>
                    </div>
                </div>
            </div>

            <!-- Main Content -->
            <div class="main-content">
                <!-- Form Section (Only for Admin) -->
                <section class="form-section" id="formSection">
                    <div class="card form-card">
                        <div class="card-title">
                            <div class="card-icon">
                                <i class="fas fa-plus-circle"></i>
                            </div>
                            <h2 id="formTitle">تلفون جدید ثبت کړئ</h2>
                        </div>
                        
                        <form id="phoneForm">
                            <div class="form-group">
                                <label for="brand" id="brandLabel">برانډ (مارک)</label>
                                <input type="text" id="brand" class="form-control" placeholder="د تلفون برانډ" required>
                            </div>
                            
                            <div class="form-group">
                                <label for="model" id="modelLabel">مودل</label>
                                <input type="text" id="model" class="form-control" placeholder="د تلفون مودل" required>
                            </div>
                            
                            <div class="form-group">
                                <label for="price" id="priceLabel">قیمت (افغانی)</label>
                                <div class="price-input-container">
                                    <input type="number" id="price" class="form-control" placeholder="قیمت" min="0" required>
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label id="partsLabel">قطعات (پرزه‌جاتی)</label>
                                <div class="checkbox-group" id="partsContainer">
                                    <!-- Parts will be added by JavaScript -->
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label for="description" id="descriptionLabel">اضافی معلومات</label>
                                <textarea id="description" class="form-control" rows="3" placeholder="د تلفون په اړه نور معلومات"></textarea>
                            </div>
                            
                            <input type="hidden" id="recordId">
                            
                            <div class="form-actions">
                                <button type="submit" class="btn btn-primary" id="submitBtn">
                                    <i class="fas fa-save"></i>
                                    <span id="submitBtnText">ثبت کړئ</span>
                                </button>
                                <button type="button" class="btn btn-secondary" id="resetBtn">
                                    <i class="fas fa-redo"></i>
                                    <span id="resetBtnText">پاک کړئ</span>
                                </button>
                                <button type="button" class="btn btn-danger" id="resetDbBtn" style="display: none;">
                                    <i class="fas fa-database"></i>
                                    <span id="resetDbBtnText">بازنشانی دیتابیس</span>
                                </button>
                            </div>
                        </form>
                    </div>
                </section>

                <!-- Data Table Section -->
                <section class="data-table-section">
                    <div class="card table-card">
                        <div class="card-title">
                            <div class="card-icon">
                                <i class="fas fa-list"></i>
                            </div>
                            <h2 id="tableTitle">ثبت شوي تلفون‌ها</h2>
                        </div>
                        
                        <div class="table-container">
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th width="15%">برانډ</th>
                                        <th width="15%">مودل</th>
                                        <th width="15%">قیمت</th>
                                        <th width="30%">قطعات</th>
                                        <th width="25%" id="actionsHeader">عملیات</th>
                                    </tr>
                                </thead>
                                <tbody id="phoneTableBody">
                                    <tr id="emptyRow">
                                        <td colspan="5">
                                            <div class="empty-state">
                                                <div class="empty-state-icon">
                                                    <i class="fas fa-mobile-alt"></i>
                                                </div>
                                                <h3>هیڅ تلفون ثبت نه دی</h3>
                                                <p id="emptyTableText">تر اوسه هیڅ تلفون ثبت نه دی شوی.</p>
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </section>
            </div>
        </div>
    </div>

    <!-- Toast Notification -->
    <div id="toast" class="toast">
        <div class="toast-icon">
            <i class="fas fa-check-circle"></i>
        </div>
        <div class="toast-content">
            <h4 id="toastTitle">موفقیت</h4>
            <p id="toastMessage">عملیات با موفقیت انجام شد</p>
        </div>
        <button id="toastClose" style="background: none; border: none; color: var(--gray-dark); cursor: pointer;">
            <i class="fas fa-times"></i>
        </button>
    </div>

    <script src="script.js"></script>
      
</body>
</html>
